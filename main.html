<html>
<header>

<!-- Jquery函式庫 -->
<script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>

<link rel=stylesheet type="text/css" href="main.css">
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAWSAImRXejAli-yp9vUlo3LhcsBNezx_Q"></script>
<script src="Location.js"></script>
</header>

<body>

<div id="pixnet">
<a href="https://www.pixnet.net/"><img src="Pixnet_logo.png"></img></a>
</div>

<div id="list">
	<form>
		<input type="text" name="search"> 
		<select>
			<option>Brands</option>
			<option>Product Name</option>
		</select> 
		<button type="button">SEARCH</button>
		<a href="member/index.php"><button type="button">Login</button></a>
		<a href="member/member_join_form.php"><button type="button">Register</button></a>
		<button type="button" onclick="getLocation()">Location</button>
	</form>
	
</div>



<!-- 文章修改 -->
<div id="article">
  <!-- article_block是底部方塊，URL是網站連結，img是圖片，transparent是透明遮罩，title是title -->
  <div id="article_block"><a id="URL0" target="_blank"><img id="img0"  height="260" src=""><div id="transparent"><div id="title0"></div></div></a></div>

  <div id="article_block"><a id="URL1" target="_blank"><img id="img1"  height="260" src=""><div id="transparent"><div id="title1"></div></div></a></div>

  <div id="article_block"><a id="URL2" target="_blank"><img id="img2"  height="260" src=""><div id="transparent"><div id="title2"></div></div></a></div>

  <div id="article_block"><a id="URL3" target="_blank"><img id="img3"  height="260" src=""><div id="transparent"><div id="title3"></div></div></a></div>

  <div id="article_block"><a id="URL4" target="_blank"><img id="img4"  height="260" src=""><div id="transparent"><div id="title4"></div></div></a></div>

  <div id="article_block"><a id="URL5" target="_blank"><img id="img5"  height="260" src=""><div id="transparent"><div id="title5"></div></div></a></div>

  <div id="article_block"><a id="URL6" target="_blank"><img id="img6"  height="260" src=""><div id="transparent"><div id="title6"></div></div></a></div>

  <div id="article_block"><a id="URL7" target="_blank"><img id="img7"  height="260" src=""><div id="transparent"><div id="title7"></div></div></a></div>
 
<!-- Json資料處理 ↓↓ -->
  <script type="text/javascript">
 
  //利用jquery裡的ajax方式，從API中取得json資料檔
  $.ajax({
    url: "https://emma.pixnet.cc/mainpage/blog/categories/hot/0?format=json&pretty_print=1&api_version=2&per_page=30",
    data: $('#sentToBack').serialize(),
    type:"GET",
    dataType:'json',
    success: function(callBack){
      
      //這裡註解的部分是參考資料。

      //字串化我們所得到的JSON資料
      //var dataStr = JSON.stringify(callBack,null,2);
      //alert(callBack.articles[6].thumb);
      //var dataObj = JSON.parse(back);  

      //呼叫JSON檔裡單獨欄位
      //alert(back.blog.name);
      //document.write(callBack.articles[6].thumb);

      //連結到對應的部落格
      var urls = new Array();
      for(i=0; i<8; i++)
      {
          urls[i] = callBack.articles[i].link;
      }  
      document.getElementById("URL0").href = urls[0];
      document.getElementById("URL1").href = urls[1];
      document.getElementById("URL2").href = urls[2];
      document.getElementById("URL3").href = urls[3];
      document.getElementById("URL4").href = urls[4];
      document.getElementById("URL5").href = urls[5];
      document.getElementById("URL6").href = urls[6];
      document.getElementById("URL7").href = urls[7];

      //透過json取得圖片，並顯示在html上
      var thumb = new Array();
      for(i=0; i<8; i++)
      {
          thumb[i] = callBack.articles[i].thumb;

          //修改url 改變圖片大小使清晰
		  var pic = thumb[i].split("zoomcrop/");
		  if(pic.length>1)
		  {
		    pic[0] += "zoomcrop/200x200.png";
			thumb[i] = pic[0];
		  }
		  else
		  {
		    pic = thumb[i].split("width=");
			if(pic.length>1)
			{
			  pic[0] += "width=200&height=200";
			  thumb[i] = pic[0];
			}
		  }	
      }  
      document.getElementById("img0").src = thumb[0];
      document.getElementById("img1").src = thumb[1];
      document.getElementById("img2").src = thumb[2];
      document.getElementById("img3").src = thumb[3];
      document.getElementById("img4").src = thumb[4];
      document.getElementById("img5").src = thumb[5];
      document.getElementById("img6").src = thumb[6];
      document.getElementById("img7").src = thumb[7];

      //透過json取得title，並顯示在html上
      document.getElementById("title0").textContent = callBack.articles[0].title;
      document.getElementById("title1").textContent = callBack.articles[1].title;
      document.getElementById("title2").textContent = callBack.articles[2].title;
      document.getElementById("title3").textContent = callBack.articles[3].title;
      document.getElementById("title4").textContent = callBack.articles[4].title;
      document.getElementById("title5").textContent = callBack.articles[5].title;
      document.getElementById("title6").textContent = callBack.articles[6].title;
      document.getElementById("title7").textContent = callBack.articles[7].title;

    },
    error:function(xhr, ajaxOptions, thrownError){ 
        alert(xhr.status); 
        alert(thrownError); 
    } 
});


alert(callBack.articles[0].link);
</script>
<!-- ↑↑ -->


</div>

<div id="store">
	<h1>store</h1>
</div>


<div id="googlemap">
	<h1>google map</h1>
</div>

<div style="width:100%; height:100%">
	<img src="ball.png" onClick="dialog(this);switchMenu(this,'collection')" onmousedown="grab(this)"></img>
</div>
	
<div id="collection" style="display:none; width:300px; height:300px;  background-image:url('menuback.png')">
    
    <h3 style="position:absolute; top:15px; left:25px;">收藏文章</h3>
    <h4 id="myArticle"></h4>

    <!-- 球球內文的Js資料! -->
    <script type="text/javascript">
    // 預計要放JS的地方，尚未完成。
    </script>
   
</div>


<!--<script >
//var x=document.getElementById("demo");
function getLocation()
  {
  if (navigator.geolocation)
    {
    navigator.geolocation.getCurrentPosition(showPosition);
    }
  else{x.innerHTML="Geolocation is not supported by this browser.";}
  }
  //獲取目前位置
function showPosition(position)
  {
  var lat,lng;
  lat = position.coords.latitude;
  lng = position.coords.longitude;
  /*x.innerHTML="Latitude: " + lat + 
  "<br />Longitude: " + lng;*/
  initialize(lat,lng)  
  }
  function initialize(latitude,longitude) {
        var myLatlng = new google.maps.LatLng(latitude,longitude);
        var mapOptions = {
          center: { lat: latitude, lng: longitude},
          zoom: 15
        };
		//地圖設定
        var map = new google.maps.Map(
            document.getElementById('googlemap'),
            mapOptions);
		//畫出map
		var marker = new google.maps.Marker({
            position: myLatlng,
            title:"目前位置"
            });
		//標記地點
		marker.setMap(map);		
      }
</script>-->

<script type="text/javascript"><!--寶貝球js code-->
		var mousex = 0;
		var mousey = 0;
		var grabx = 0;
		var graby = 0;
		var orix = 0;
		var oriy = 0;
		var elex = 0;
		var eley = 0;
		var algor = 0;
		var openimg = 0;

		var dragobj = null;



		function falsefunc() { return false; } // used to block cascading events
	
		function init()
		{
			document.onmousemove = update; // update(event) implied on NS, update(null) implied on IE
			update();
		}

		function getMouseXY(e) // works on IE6,FF,Moz,Opera7
		{ 
			if (!e) e = window.event; // works on IE, but not NS (we rely on NS passing us the event)

			if (e)
			{ 
				if (e.pageX || e.pageY)
				{ // this doesn't work on IE6!! (works on FF,Moz,Opera7)
					mousex = e.pageX;
					mousey = e.pageY;
					algor = '[e.pageX]';
					if (e.clientX || e.clientY) algor += ' [e.clientX] '
				}
			else if (e.clientX || e.clientY)
			{ // works on IE6,FF,Moz,Opera7
				mousex = e.clientX + document.body.scrollLeft;
				mousey = e.clientY + document.body.scrollTop;
				algor = '[e.clientX]';
				if (e.pageX || e.pageY) algor += ' [e.pageX] '
			}  
			}
		}

		function update(e)
		{
			if(openimg!=1)
			getMouseXY(e); // NS is passing (event), while IE is passing (null)
		}

		function grab(context)
		{
			document.onmousedown = falsefunc; // in NS this prevents cascading of events, thus disabling text selection
			dragobj = context;
			dragobj.style.zIndex = 10; // move it to the top
			document.onmousemove = drag;
			document.onmouseup = drop;
			grabx = mousex;
			graby = mousey;
			elex = orix = dragobj.offsetLeft;
			eley = oriy = dragobj.offsetTop;
			update();
		}

		function drag(e) // parameter passing is important for NS family 
		{
			if (dragobj)
			{
				elex = orix + (mousex-grabx);
				eley = oriy + (mousey-graby);
				dragobj.style.position = "absolute";
				dragobj.style.left = (elex).toString(10) + 'px';
				dragobj.style.top  = (eley).toString(10) + 'px';
			}
		update(e);
		return false; // in IE this prevents cascading of events, thus text selection is disabled
		}

		function drop()
		{
			if (dragobj)
			{
			dragobj.style.zIndex = 0;
			dragobj = null;
			}
			update();
			document.onmousemove = update;
			document.onmouseup = null;
			document.onmousedown = null;   // re-enables text selection on NS
		}
		
		function dialog(MyImage)
		{	
			if((mousex-grabx)==0&&(mousey-graby)==0){
				if (openimg == 0){
					MyImage.src = "open.png";
					this.openimg = 1;
					document.getElementById('SubMenu2');
				}
				else if (this.openimg == 1){
					MyImage.src = "ball.png";
					openimg = 0;

				}
			}
		}
		
		var VisibleMenu = ''; // 記錄目前顯示的子選單的 ID
		// 顯示或隱藏子選單
		function switchMenu( theMainMenu, theSubMenu, theEvent ){
		if((mousex-grabx)==0&&(mousey-graby)==0){
			var SubMenu = document.getElementById( theSubMenu );
			if( SubMenu.style.display == 'none' ){ // 顯示子選單
				SubMenu.style.minWidth = theMainMenu.clientWidth; // 讓子選單的最小寬度與主選單相同 (僅為了美觀)
				SubMenu.style.display = 'block';
				hideMenu(); // 隱藏子選單
				VisibleMenu = theSubMenu;
			}
			else{ // 隱藏子選單
				if( theEvent != 'MouseOver' || VisibleMenu != theSubMenu ){
					SubMenu.style.display = 'none';
					VisibleMenu = '';
				}
			}
			SubMenu.style.position='absolute';
			SubMenu.style.top=eley+30 + 'px';
			SubMenu.style.left=elex-300 + 'px';
		}
		}

		// 隱藏子選單
		function hideMenu(){
		if( VisibleMenu != '' ){
			document.getElementById( VisibleMenu ).style.display = 'none';
		}
		VisibleMenu = '';
		}
	</script>
</body>
</html>